# Inheriting ScpiInstrument

SCPI(Standard Control of Programmbale Instruments) is a standard used for controlling test and measurement devices. It is an ASCII-based instrument control language, with many common commands and patterns. The `ScpiInstrument` class was created to act as a parent class to drivers for specific instruments.

The `ScpiInstrument` class uses the `ScpiCommandConstr` class, which transforms attribute calls into SCPI commands. More information [here](#construct-commands). For example, the user can instatiate the object then call `self.sour.volt.limit()` to query the voltage limit, sending a "SOURce:VOLTage:LIMIT?" SCPI command.

## Getting Started
Inherit the class
```python
class DriverXYZ(ScpiInstrument):
```

Connect to the instrument (ie. using serial or socket)
```python
serial_dev = DriverSerial(port, baudrate)
super().__init__(serial_dev)
```
Now all functions and attributes can be accessed through `self`.

## Common Commands
Standard SCPI commands are wrapped in functions within the `ScpiInstrument` class, and are universally accepted by devices which communicate with the protocol.

Identify the instrument
```python
info = self.get_info()
```

## Construct Commands
Commands can be executed by using attributes, and under the hood the expected SCPI format is generated by the `ScpiCommandConstr` class. Any attribute without arguments will be a query, meaning calling `self.meas.volt()` will resolve to sending "MEAS:VOLT?" and expecting a response.

Commands with arguments will have that value passed into the message. Calling `self.sour.volt(5)` will send a SCPI command of "SOUR:VOLT 5".

There are exceptions where a user will want to send a raw command. The logic requires a '?' to be part of the input string. For example, `self.curr('? MAX')` sends "CURR? MAX" to set the current value of the selected channel to the max.

### Examples

Query
```python
test = ScpiInstrument()
test.meas.volt()  # MEAS:VOLT?
```

Send with input argument
```python
channel = 1
test.sour.volt(5)  # SOUR:VOLT 5
self.conf.curr.ac(cmd)  # CONF:CURR:AC 1
self.rout.scan(cmd)  # ROUT:SCAN 1
```

Send and receive with input as raw message
```python
cmd = "? 1"
self.syst.ctyp(cmd)  # SYST:CTYP? 1
```

### Reference
https://github.com/bicarlsen/easy-scpi
